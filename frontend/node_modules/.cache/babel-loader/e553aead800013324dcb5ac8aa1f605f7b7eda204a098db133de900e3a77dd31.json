{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport { toHandlers } from \"vue\";\nimport 'vue-toast-notification/dist/theme-bootstrap.css';\nimport { useToast } from 'vue-toast-notification';\nexport default {\n  name: 'Login',\n  setup() {\n    const toast = useToast();\n    return {\n      toast\n    };\n  },\n  data() {\n    return {\n      username: '',\n      password: '',\n      errors: []\n    };\n  },\n  components: {\n    VueToast\n  },\n  methods: {\n    submitForm() {\n      console.log('submit!');\n      axios.defaults.headers.common['Authorization'] = \"\";\n      localStorage.removeItem('token');\n      this.errors = [];\n      if (this.username === '') {\n        this.errors.push('the username is missing!');\n        console.log('empty email');\n        this.triggerEmptyUserName();\n      }\n      if (this.password === '') {\n        this.errors.push('password is missing');\n      }\n      if (!this.errors.length) {\n        const formData = {\n          username: this.username,\n          password: this.password\n        };\n        axios.post('token/login/', formData).then(response => {\n          const token = response.data.auth_token;\n          this.$store.commit('setToken', token);\n          axios.defaults.headers.common['Authorization'] = \"Token \" + token;\n          localStorage.setItem('token', token);\n          this.$router.push('/dashboard/my-account');\n        }).catch(error => {\n          if (error.response) {\n            for (const property in error.response.data) {\n              this.errors.push(`${property}:${error.response.data[property]}`);\n            }\n            console.log(JSON.stringify(error.response.data));\n          } else if (error.message) {\n            this.errors.push('something went wrong try again');\n            this.$toast.warning('something went wrong try again');\n            console.log(JSON.stringify(error));\n          }\n        });\n      }\n    },\n    triggerEmptyUserName() {\n      this.$toast.warning(\"empty user name\");\n    }\n  }\n};","map":{"version":3,"names":["axios","toHandlers","useToast","name","setup","toast","data","username","password","errors","components","VueToast","methods","submitForm","console","log","defaults","headers","common","localStorage","removeItem","push","triggerEmptyUserName","length","formData","post","then","response","token","auth_token","$store","commit","setItem","$router","catch","error","property","JSON","stringify","message","$toast","warning"],"sources":["/home/toree/Desktop/vue-drf-blog-dj/frontend/src/views/Login.vue"],"sourcesContent":["<template>\n    <div class=\"d-flex justify-content-center align-items-center my-5\">\n        <div class=\"title w-50 d-flex justify-content-center w-100\">\n            <div class=\"w-50 d-flex justify-content-center\">    \n                <form  v-on:submit.prevent=\"submitForm\"  class=\"col-md-4 col-md-offset-4\">    \n                <div class=\"form-group\">\n                    <h1 class=\"my-3\">Login!</h1>\n          \n                    <label for=\"exampleInputEmail1\">Email address</label>\n                    <input v-model=\"username\" type=\"email\" class=\"form-control mb-3\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"Enter email\">\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"exampleInputPassword1\">Password</label>\n                    <input v-model=\"password\" type=\"password\" class=\"form-control mb-3\" id=\"exampleInputPassword1\" placeholder=\"Password\">\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Login</button>\n                </form>\n    \n                <div v-if=\"errors.length\" class=\"toast\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\">\n                    <div class=\"toast-header\">\n                        <p v-for=\"error in errors\"\n                        v-bind:key=\"error\">{{ error }}</p>\n                    </div>\n    \n                </div>\n    \n            </div>\n           \n        </div>\n    \n    </div>\n    \n    \n    \n    </template>\n    \n    <script>\n    \n    import axios from \"axios\";\n    import { toHandlers } from \"vue\";\n    import 'vue-toast-notification/dist/theme-bootstrap.css'\n    import { useToast } from 'vue-toast-notification';\n     \n    export default {\n        name:'Login',\n\n        setup(){\n    const toast = useToast();\n    return {toast}\n    },\n    \n    \n        data(){\n            return {\n                username:'',\n                password:'',\n                errors:[]\n            }\n        },\n        components:{\n            VueToast\n        },\n        methods:{\n            submitForm (){\n                console.log('submit!')\n\n                axios.defaults.headers.common['Authorization']= \"\"\n\n                localStorage.removeItem('token')\n                \n                this.errors=[]\n                \n                if(this.username === ''){\n                    this.errors.push('the username is missing!')\n                    console.log('empty email')\n                    this.triggerEmptyUserName()\n                }\n                if(this.password === '' ){\n                    this.errors.push('password is missing')\n                }\n                if(!this.errors.length){\n                    const formData = {\n                        username: this.username,\n                        password: this.password\n                    }\n                    axios\n                        .post('token/login/', formData)\n                        .then(response => {\n                            const token = response.data.auth_token\n\n                            this.$store.commit('setToken', token)\n\n                            axios.defaults.headers.common['Authorization'] = \"Token \" + token\n\n                            localStorage.setItem('token', token)\n\n                            this.$router.push('/dashboard/my-account')\n                        })\n                        .catch(error => {\n                            if(error.response){\n                                for(const property in error.response.data){\n                                    this.errors.push(`${property}:${error.response.data[property]}`)\n                                }\n                                console.log(JSON.stringify(error.response.data))\n                            } else if (error.message) {\n                                this.errors.push('something went wrong try again')\n                                this.$toast.warning('something went wrong try again')\n                                console.log(JSON.stringify(error))\n                            }\n                        })\n                }\n            },\n            triggerEmptyUserName(){\n                this.$toast.warning(\"empty user name\")\n            }\n        }\n    }\n    \n    </script>"],"mappings":";AAsCI,OAAOA,KAAI,MAAO,OAAO;AACzB,SAASC,UAAS,QAAS,KAAK;AAChC,OAAO,iDAAgD;AACvD,SAASC,QAAO,QAAS,wBAAwB;AAEjD,eAAe;EACXC,IAAI,EAAC,OAAO;EAEZC,KAAKA,CAAA,EAAE;IACX,MAAMC,KAAI,GAAIH,QAAQ,CAAC,CAAC;IACxB,OAAO;MAACG;IAAK;EACb,CAAC;EAGGC,IAAIA,CAAA,EAAE;IACF,OAAO;MACHC,QAAQ,EAAC,EAAE;MACXC,QAAQ,EAAC,EAAE;MACXC,MAAM,EAAC;IACX;EACJ,CAAC;EACDC,UAAU,EAAC;IACPC;EACJ,CAAC;EACDC,OAAO,EAAC;IACJC,UAASA,CAAA,EAAI;MACTC,OAAO,CAACC,GAAG,CAAC,SAAS;MAErBf,KAAK,CAACgB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAE,EAAC;MAEjDC,YAAY,CAACC,UAAU,CAAC,OAAO;MAE/B,IAAI,CAACX,MAAM,GAAC,EAAC;MAEb,IAAG,IAAI,CAACF,QAAO,KAAM,EAAE,EAAC;QACpB,IAAI,CAACE,MAAM,CAACY,IAAI,CAAC,0BAA0B;QAC3CP,OAAO,CAACC,GAAG,CAAC,aAAa;QACzB,IAAI,CAACO,oBAAoB,CAAC;MAC9B;MACA,IAAG,IAAI,CAACd,QAAO,KAAM,EAAC,EAAG;QACrB,IAAI,CAACC,MAAM,CAACY,IAAI,CAAC,qBAAqB;MAC1C;MACA,IAAG,CAAC,IAAI,CAACZ,MAAM,CAACc,MAAM,EAAC;QACnB,MAAMC,QAAO,GAAI;UACbjB,QAAQ,EAAE,IAAI,CAACA,QAAQ;UACvBC,QAAQ,EAAE,IAAI,CAACA;QACnB;QACAR,KAAI,CACCyB,IAAI,CAAC,cAAc,EAAED,QAAQ,EAC7BE,IAAI,CAACC,QAAO,IAAK;UACd,MAAMC,KAAI,GAAID,QAAQ,CAACrB,IAAI,CAACuB,UAAS;UAErC,IAAI,CAACC,MAAM,CAACC,MAAM,CAAC,UAAU,EAAEH,KAAK;UAEpC5B,KAAK,CAACgB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,QAAO,GAAIU,KAAI;UAEhET,YAAY,CAACa,OAAO,CAAC,OAAO,EAAEJ,KAAK;UAEnC,IAAI,CAACK,OAAO,CAACZ,IAAI,CAAC,uBAAuB;QAC7C,CAAC,EACAa,KAAK,CAACC,KAAI,IAAK;UACZ,IAAGA,KAAK,CAACR,QAAQ,EAAC;YACd,KAAI,MAAMS,QAAO,IAAKD,KAAK,CAACR,QAAQ,CAACrB,IAAI,EAAC;cACtC,IAAI,CAACG,MAAM,CAACY,IAAI,CAAE,GAAEe,QAAS,IAAGD,KAAK,CAACR,QAAQ,CAACrB,IAAI,CAAC8B,QAAQ,CAAE,EAAC;YACnE;YACAtB,OAAO,CAACC,GAAG,CAACsB,IAAI,CAACC,SAAS,CAACH,KAAK,CAACR,QAAQ,CAACrB,IAAI,CAAC;UACnD,OAAO,IAAI6B,KAAK,CAACI,OAAO,EAAE;YACtB,IAAI,CAAC9B,MAAM,CAACY,IAAI,CAAC,gCAAgC;YACjD,IAAI,CAACmB,MAAM,CAACC,OAAO,CAAC,gCAAgC;YACpD3B,OAAO,CAACC,GAAG,CAACsB,IAAI,CAACC,SAAS,CAACH,KAAK,CAAC;UACrC;QACJ,CAAC;MACT;IACJ,CAAC;IACDb,oBAAoBA,CAAA,EAAE;MAClB,IAAI,CAACkB,MAAM,CAACC,OAAO,CAAC,iBAAiB;IACzC;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}